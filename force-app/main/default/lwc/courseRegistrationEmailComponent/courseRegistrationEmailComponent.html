<template>
  <c-course-registration-email-confirmation
    if:true={viewConfirmationWindow}
    course-id={recordId}
    recipients={recipients}
    template-name="courseRegistrationInvitation"
    use-do-not-reply="false"
    oncancel={closeConfirmation}
  >
  </c-course-registration-email-confirmation>

  <lightning-card
    variant="Narrow"
    title="Send invitasjon"
    icon-name="standard:email_chatter"
  >
    <lightning-button-group slot="actions">
      <lightning-button label="Importer"> </lightning-button>
      <lightning-button
        label="GÃ¥ til bekreftelse"
        onclick={openConfirmation}
        variant="brand"
        disabled={isConfirmDisabled}
      >
      </lightning-button>
    </lightning-button-group>

    <div class="slds-p-horizontal_small" if:false={emailSent}>
      <!-- LIST OF ADDED USERS -->

      <div class="slds-p-bottom_small" if:true={hasRecipients}>
        <lightning-pill-container
          variant="bare"
          items={recipients}
          onitemremove={handleItemRemove}
        >
        </lightning-pill-container>
      </div>
      <!-- TODO fix padding -->

      <!-- NAME -->
      <lightning-layout>
        <lightning-layout-item class="slds-p-right_x-small" size="6">
          <lightning-input
            name="firstName"
            type="text"
            label="Fornavn"
            required
          ></lightning-input>
        </lightning-layout-item>

        <lightning-layout-item class="slds-p-left_x-small" size="6">
          <lightning-input
            name="lastName"
            type="text"
            label="Etternavn"
            required
          ></lightning-input>
        </lightning-layout-item>
      </lightning-layout>

      <!-- EMAIL -->
      <lightning-input
        class="slds-p-vertical_small"
        name="email"
        type="text"
        pattern={emailRegex}
        label="E-post"
        required
      >
      </lightning-input>

      <!-- GDPR AND ADD -->
      <lightning-layout class="slds-p-vertical_small" vertical-align="center">
        <!-- GDPR CHECKBOX -->
        <lightning-layout-item class="slds-p-right_x-small" flexibility="grow">
          <lightning-layout vertical-align="center" if:true={hasRecipients}>
            <lightning-layout-item flexibility="auto">
              <lightning-input
                name="checkbox"
                type="checkbox-button"
                onchange={checkbox}
                data-target-id="gdprCheckbox"
                label="Kontaktpersoner er informert om at de lagres som kontakter"
              >
              </lightning-input>
            </lightning-layout-item>
            <lightning-layout-item
              flexibility="auto"
              padding="horizontal-small"
              class="slds-p-bottom_xx-small"
            >
              <span
                >Kontaktpersoner er informert om at de lagres som kontakter
              </span>
            </lightning-layout-item>
          </lightning-layout>
        </lightning-layout-item>

        <!-- ADD PERSON -->
        <lightning-layout-item flexibility="no-shrink">
          <lightning-button
            variant="brand-outline"
            label="Legg til"
            class="slds-p-bottom_xx-small"
            onclick={addEmail}
          >
          </lightning-button>
        </lightning-layout-item>
      </lightning-layout>
    </div>

    <div if:true={emailSent}>
      <h1 class="slds-align_absolute-center"><b>Mailen ble sendt!</b></h1>
    </div>
  </lightning-card>
</template>
