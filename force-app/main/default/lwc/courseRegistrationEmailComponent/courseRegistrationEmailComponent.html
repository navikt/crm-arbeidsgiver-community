<template>
  <c-course-registration-email-confirmation
    if:true={viewConfirmationWindow}
    course-id={recordId}
    recipients={recipients}
    template-name="courseRegistrationInvitation"
    use-do-not-reply="false"
    oncancel={closeConfirmation}
  >
  </c-course-registration-email-confirmation>

  <lightning-card
    variant="Narrow"
    title={labels.title}
    icon-name="standard:email_chatter"
  >
    <lightning-button-group slot="actions">
      <lightning-button label={labels.importBtn}> </lightning-button>
      <lightning-button
        label={labels.goToConfirmation}
        onclick={openConfirmation}
        variant="brand"
        disabled={isConfirmDisabled}
      >
      </lightning-button>
    </lightning-button-group>

    <div class="slds-p-horizontal_small" if:false={emailSent}>
      <!-- LIST OF ADDED USERS -->

      <div class="slds-p-bottom_small" if:true={hasRecipients}>
        <lightning-pill-container
          variant="bare"
          items={recipients}
          onitemremove={handleItemRemove}
        >
        </lightning-pill-container>
      </div>
      <!-- TODO fix padding -->

      <lightning-layout multiple-rows>
        <!-- NAME -->
        <lightning-layout-item class="slds-p-right_x-small" size="6">
          <lightning-input
            name="firstName"
            type="text"
            label={labels.name}
            required
          ></lightning-input>
        </lightning-layout-item>

        <lightning-layout-item class="slds-p-left_x-small" size="6">
          <!-- EMAIL -->
          <lightning-input
            name="email"
            type="text"
            pattern={emailRegex}
            message-when-pattern-mismatch={labels.emailValidation}
            label={labels.email}
            required
          >
          </lightning-input>
        </lightning-layout-item>
        <lightning-layout-item
          class="slds-p-vertical_large"
          flexibility="grow"
          size="12"
        >
          <button
            class="slds-button slds-button_neutral slds-button_stretch"
            onclick={addEmail}
          >
            {labels.addRecipient}
          </button>
        </lightning-layout-item>
      </lightning-layout>
    </div>

    <div if:true={emailSent}>
      <h1 class="slds-align_absolute-center"><b>Mailen ble sendt!</b></h1>
    </div>
  </lightning-card>
</template>
